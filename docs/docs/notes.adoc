[#notes]
= 碎碎念

. CAP
. X/Open DTP
. Two Phase Commit
.. MySQL XA
.. 还有其他框架，比如 JMS 实现 XA 协议吗？
. Three Phase Commit
. Paxos
. ZooKeeper
. Raft
. 事务消息
.. RocketMQ -- https://rocketmq.apache.org/zh/docs/featureBehavior/04transactionmessage/[事务消息 | RocketMQ^]
. 基于本地消息表的分布式事务
. 最大努力通知
. TCC（Try-Confirm-Cancel） -- TCC 实际上是服务化的两阶段提交协议
.. 接入 TCC ，最重要的是考虑如何将自己的业务模型拆成两阶段来实现。
. SAGA
. Seata 的实现
.. AT 模式 -- 用户业务 SQL，框架会自动生成事务的二阶段提交和回滚操作。
... 成功则提交，清除快照数据和锁。
... 失败，则首先检查是否“脏写”（从单个数据库来看，不是脏写。），没有则自动回滚；有则交由人工处理。❓：如果并发很高的情况下，这里会不会出现大量需要人工处理的脏写数据？
.. XA 模式 -- 基于数据库的 XA 协议来实现。对 MySQL 支持比较完善；对 Oracle 的支持略有不足。 https://developer.aliyun.com/article/783796[6 张图带你彻底搞懂分布式事务 XA 模式^] -- 疑问❓：标准的 XA 协议到底是 2PC，还是 3PC？
.. TCC
.. SATA
... 不能保证隔离性
... Saga 的实现一般有两种，一种是通过事件驱动架构实现，一种是基于注解加拦截器拦截业务的正向服务实现。Seata 目前是采用事件驱动的机制来实现的，Seata 实现了一个状态机，可以编排服务的调用流程及正向服务的补偿服务，生成一个 json 文件定义的状态图，


== 参考资料

. https://seata.apache.org/zh-cn/blog/seata-at-tcc-saga[分布式事务 Seata 及其三种模式详解^]
. https://www.thebyte.com.cn/distributed-system/transaction.html[分布式事务协议与解决 | 深入架构原理与实践^]

